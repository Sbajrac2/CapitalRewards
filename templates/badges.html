<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn Badges</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="static/css/homepage.css">
    <style>
        .primary-color { background-color: #004977; }
        .secondary-color { background-color: #D03027; }
    </style>
</head>
<body class="bg-white text-gray-900">

<!-- Navbar -->
<nav class="primary-color text-white py-4 px-6 flex justify-between items-center">
    <h1 class="text-2xl font-bold">CapitalRewards</h1>
    <ul class="flex space-x-6">
        <li><a href="homepage" class="hover:text-gray-300">Home</a></li>
        <li><a href="badges" class="hover:text-gray-300">Badges</a></li>
        <li><a href="Chatpage" class="hover:text-gray-300">AI Chatbox</a></li>
        <li><a href="loginpage" class="secondary-color px-4 py-2 rounded-lg hover:bg-red-700">Login</a></li>
    </ul>
</nav>


<!-- Badges Section -->
<section id="badges" class="py-16 bg-gray-100 text-center relative">
    <p id="total-points-display" class="mt-4 text-lg font-semibold text-gray-700">
        Total Points: 0
    </p>
    <h2 class="text-3xl font-semibold text-gray-900 mb-6">Earn Badges for Your Savings!</h2>
    <p class="text-gray-600 max-w-xl mx-auto">
        Save smartly and get rewarded! The more you save, the more badges you unlock.
    </p>
    <div class="mt-8 flex flex-wrap justify-center gap-6 max-w-screen-md mx-auto">
        <!-- First Row -->
        <div class="p-6 bg-white shadow-lg rounded-lg">
            <div class="badge1">
                <img src="static/images/badge1.png" alt="Badge 1" class="mx-auto">
            </div>
            <p class="mt-4 font-semibold">Starter Saver</p>
            <p class="text-sm text-gray-500">Save $10 to unlock</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="badge1-progress" class="bg-red-600 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
            <p id="badge1-text" class="mt-2 text-xs text-gray-500">0% Complete</p>
            <p class="mt-2 text-xs text-gray-500">100 Points</p>

        </div>
        <div class="p-6 bg-white shadow-lg rounded-lg">
            <div class="badge2">
                <img src="static/images/badge2.png" alt="Badge 2" class="mx-auto">
            </div>
            <p class="mt-4 font-semibold">Smart Investor</p>
            <p class="text-sm text-gray-500">Save $100 to unlock</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="badge2-progress" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
            <p id="badge2-text" class="mt-2 text-xs text-gray-500">0% Complete</p>
            <p class="mt-2 text-xs text-gray-500">1000 Points</p>


        </div>
        <div class="p-6 bg-white shadow-lg rounded-lg">
            <div class="badge3">
                <img src="static/images/badge3.png" alt="Badge 3" class="mx-auto">
            </div>
            <p class="mt-4 font-semibold">Financial Guru</p>
            <p class="text-sm text-gray-500">Save $250 to unlock</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="badge3-progress" class="bg-green-600 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
            <p id="badge3-text" class="mt-2 text-xs text-gray-500">0% Complete</p>
            <p class="mt-2 text-xs text-gray-500">2,500 Points</p>
        </div>

        <!-- Second Row -->
        <div class="p-6 bg-white shadow-lg rounded-lg">
            <div class="badge4">
                <img src="static/images/badge4.png" alt="Badge 4" class="mx-auto">
            </div>
            <p class="mt-4 font-semibold">Savings Master</p>
            <p class="text-sm text-gray-500">Save $500 to unlock</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="badge4-progress" class="bg-green-600 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
            <p id="badge4-text" class="mt-2 text-xs text-gray-500">0% Complete</p>
            <p class="mt-2 text-xs text-gray-500">5,000 Points</p>
        </div>
        <div class="p-6 bg-white shadow-lg rounded-lg">
            <div class="badge5">
                <img src="static/images/badge5.png" alt="Badge 5" class="mx-auto">
            </div>
            <p class="mt-4 font-semibold">Wealth Builder</p>
            <p class="text-sm text-gray-500">Save $1000 to unlock</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="badge5-progress" class="bg-green-600 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
            <p id="badge5-text" class="mt-2 text-xs text-gray-500">0% Complete</p>
            <p class="mt-2 text-xs text-gray-500">10,000 Points</p>
        </div>
        <div class="p-6 bg-white shadow-lg rounded-lg">
            <div class="badge6">
                <img src="static/images/badge6.png" alt="Badge 6" class="mx-auto">
            </div>
            <p class="mt-4 font-semibold">Elite Saver</p>
            <p class="text-sm text-gray-500">Save $5000 to unlock</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="badge6-progress" class="bg-green-600 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
            <p id="badge6-text" class="mt-2 text-xs text-gray-500">0% Complete</p>
            <p class="mt-2 text-xs text-gray-500">50,000 Points</p>
        </div>
    </div>

    <!-- Upcoming Badges -->
    <div class="mt-16">
        <h3 class="text-2xl font-semibold mb-6">Upcoming Badges</h3>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 max-w-4xl mx-auto">
            <div class="p-4 bg-gray-200 rounded-lg opacity-75">
                <div class="mx-auto w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center mb-2">
                    <span class="text-gray-500">?</span>
                </div>
                <p class="font-medium text-gray-500">Locked Badge</p>
                <p class="text-xs text-gray-500">Keep saving to discover</p>
            </div>
            <div class="p-4 bg-gray-200 rounded-lg opacity-75">
                <div class="mx-auto w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center mb-2">
                    <span class="text-gray-500">?</span>
                </div>
                <p class="font-medium text-gray-500">Locked Badge</p>
                <p class="text-xs text-gray-500">Keep saving to discover</p>
            </div>
            <div class="p-4 bg-gray-200 rounded-lg opacity-75">
                <div class="mx-auto w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center mb-2">
                    <span class="text-gray-500">?</span>
                </div>
                <p class="font-medium text-gray-500">Locked Badge</p>
                <p class="text-xs text-gray-500">Keep saving to discover</p>
            </div>
            <div class="p-4 bg-gray-200 rounded-lg opacity-75">
                <div class="mx-auto w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center mb-2">
                    <span class="text-gray-500">?</span>
                </div>
                <p class="font-medium text-gray-500">Locked Badge</p>
                <p class="text-xs text-gray-500">Keep saving to discover</p>
            </div>
        </div>
    </div>
    </div>
    <button onclick="resetPoints()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-700">
        Reset Progress
    </button>
</section>

<!-- Footer -->
<footer class="primary-color text-white py-6 text-center">
    <p>&copy; 2025 CapitalRewards. All rights reserved.</p>
</footer>

<script>
    function resetPoints() {
        localStorage.removeItem("rewardPoints");
        location.reload(); // Refresh the page to update progress bars
    }
</script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        let totalPoints = localStorage.getItem("rewardPoints") || 0;
        console.log("Total Points from localStorage:", totalPoints);

        if (!totalPoints) {
            console.error("⚠️ No points found in localStorage!");
            return; // Stop execution if points are missing
        }

        totalPoints = parseInt(totalPoints);
        // Update the total points display
        document.getElementById("total-points-display").innerText = `Total Points: ${totalPoints}`;

        // Load confetti history (which badges already got confetti)
        let confettiBadges = JSON.parse(localStorage.getItem("confettiBadges")) || [];

        // Define the required points for each badge level
        const badgeLevels = [
            { id: "badge1-progress", textId: "badge1-text", required: 100 },
            { id: "badge2-progress", textId: "badge2-text", required: 1000 },
            { id: "badge3-progress", textId: "badge3-text", required: 2500 },
            { id: "badge4-progress", textId: "badge4-text", required: 5000 },
            { id: "badge5-progress", textId: "badge5-text", required: 10000 },
            { id: "badge6-progress", textId: "badge6-text", required: 50000 },
        ];

        // Loop through each badge level and update the progress
        badgeLevels.forEach(badge => {
            const progressBar = document.getElementById(badge.id);
            const progressText = document.getElementById(badge.textId); //completed text?
            if (!progressBar) {
                console.error(`⚠️ Progress bar not found for ${badge.id}`);
                return;
            }

            if (!progressText) {
                console.error(`⚠️ Progress text not found for ${badge.textId}`);
                return;
            }
            if (progressBar && progressText) {
                let percentage = (totalPoints / badge.required) * 100;
                percentage = Math.min(percentage, 100); // Ensure max is 100%
                console.log(`Updating badge: ${badge.id}: ${percentage}%`);
                progressBar.style.width = percentage + "%";
                progressText.innerText = `${Math.round(percentage)}% Complete`;
            // 🎉 Trigger confetti only when `totalPoints` meets or exceeds `badge.required`
         if (totalPoints >= badge.required) {
            console.log(`🎊 Confetti triggered for ${badge.id}!`);
            
            setTimeout(() => {
                launchConfetti();
            }, 500);

            // ✅ Store this badge ID in confetti history so it doesn’t trigger again
            confettiBadges.push(badge.id);
            localStorage.setItem("confettiBadges", JSON.stringify(confettiBadges));
        } else if (totalPoints >= badge.required) {
            console.log(` Confetti NOT triggered - ${badge.id} already in localStorage.`);
        }
            }
        });
    });  
    // 🎊 Confetti Animation Function (OUTSIDE event listeners)
function launchConfetti() {
    confetti({
        particleCount: 150,
        spread: 100,
        origin: { y: 0.6 },
    });
}

</script>

</body>
</html>
